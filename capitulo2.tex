\chapter{Conceitos Preliminares}
\label{cap:conceitos_preliminares}

Neste capítulo serão apresentados conceitos fundamentais utilizados neste trabalho. Definições como imagens digitais, imagens em níveis de cinza e sua representação topográfica, extremos regionais, processamento de imagens, formas de limiarização, convolução, técnicas da morfologia matemática e reconhecimento de padrões serão abordadas a seguir.

\section{Imagens Digitais}

Uma imagem digital é uma imagem representada na forma de matriz bidimensional, sendo cada {\it pixel} a representação de um ponto pertencente a ela na forma $(x,y)$. A coordenada $x$ corresponde à linha e a coordenada $y$ à coluna daquele ponto. O {\it pixel} é a representação das características de brilho e cor para cada elemento da imagem \cite{gonzalez00}.

\begin{figure}[ht]
	\centering
	\caption{Representação de imagens digitais. (a) Imagem bidimensional. (b) Imagem piramidal.}
    \subfigure[]{
        \includegraphics[width=0.35\hsize]{imagens/figura14.png}
    }
    \hspace{3mm}
    \subfigure[]{
         \includegraphics[width=0.2\hsize]{imagens/figura15.png}
    }   \\
	Fonte: \citeonline{pedrini08}.
	\label{fig:imagens_digitais}
\end{figure}

Além da representação matricial, \citeonline{pedrini08} descrevem a possibilidade de representar uma imagem hierarquicamente, por meio de uma estrutura piramidal. Nesta estrutura, a base constitui a imagem em tamanho original e, de acordo com a elevação de nível da pirâmide, a imagem assume dimensões inferiores. De maneira geral, o nível superior representa a imagem por meio de um único {\it pixel} e o nível inferior representa a imagem original, compondo em conjunto com as demais dimensões a imagem inteira. A figura \ref{fig:imagens_digitais} mostra as duas representações citadas.

A resolução espacial de uma imagem digital é determinada pela dunidade de fotosítios contidos no sensor e utilizados para a amostragem digital de uma imagem capturada \cite{gonzalez00}. Neste processo é determinada a qualidade da imagem digitalizada por meio da definição da quantidade de {\it pixels} para representação da imagem, ou seja, a quantidade de linhas e colunas utilizadas. A amostragem de uma imagem digital pode ser visualizada na figura \ref{fig:amostragem}.

\begin{figure}[ht]
    \centering
	\caption{Amostragem em imagens digitais. (a) 20 x 20 (b) 30 x 30 (c) 64 x 64 (d) 256 x 256.}
    \subfigure[]{
        \includegraphics[width=0.22\hsize]{imagens/figura16a.png}
    }
    \hspace{0mm}
    \subfigure[]{
         \includegraphics[width=0.22\hsize]{imagens/figura16b.png}
    }   
    \hspace{0mm}
    \subfigure[]{
         \includegraphics[width=0.22\hsize]{imagens/figura16c.png}
    }
    \hspace{0mm}
    \subfigure[]{
         \includegraphics[width=0.22\hsize]{imagens/figura16d.png}
    }   \\
   Fonte: Imagens geradas pela autora.
   \label{fig:amostragem}
\end{figure}

\subsection{Imagens em Níveis de Cinza}
\label{sec:cinza}

Definida anteriormente, uma imagem digital é composta por {\it pixels} representados pela tupla $(x,y)$. Uma imagem em níveis de cinza é representada por $f_{(x,y)}$, na qual o valor da função $f$ em cada ponto denota sua intensidade de brilho (níveis de cinza) \cite{gonzalez00}. Este valor pode variar em intervalos menores para imagens definidas com menores níveis de cinza ou em intervalos maiores, como  $0$ (preto) a $255$ (branco), dependendo do processo de quantização. Este processo define a resolução em níveis de cinza de uma imagem digital, além de ser responsável pela determinação da quantidade de níveis que um ponto pode apresentar. A figura \ref{fig:quantizacao} mostra exemplos de quantização em diferentes intensidades de níveis de cinza.

\begin{figure}[ht]
	\centering
	\caption{Quantização em imagens digitais. (a) 2 intensidades (b) 4 intensidades (c) 16 intensidades (d) 256 intensidades.}
    \subfigure[]{
        \includegraphics[width=0.22\hsize]{imagens/figura17a.png}
    }
    \hspace{0mm}
    \subfigure[]{
         \includegraphics[width=0.22\hsize]{imagens/figura17b.png}
    }   
    \hspace{0mm}
    \subfigure[]{
         \includegraphics[width=0.22\hsize]{imagens/figura17c.png}
    }
    \hspace{0mm}
    \subfigure[]{
         \includegraphics[width=0.22\hsize]{imagens/figura17d.png}
    }   \\
    Fonte: Imagens geradas pela autora.
   \label{fig:quantizacao}
\end{figure}

\subsubsection{Imagem em representação topográfica}

Além das formas de representação de imagens discutidas anteriormente, é possível definir uma imagem em níveis de cinza como uma superfície topográfica. Utilizada principalmente em aplicações de segmentação de regiões de interesse, uma imagem nesta representação é definida por uma superficie na qual as intensidades dos {\it pixels} definem os valores das altitudes dos pontos e os {\it pixels} em conjunto revelam a topografia da imagem por meio de elevações (vales e picos) \cite{pedrini08}. A figura \ref{fig:topografica}, gerada pela autora por meio do software {\it MayaVi}\footnote{Página para maiores informações: http://mayavi.sourceforge.net/}, mostra uma imagem em níveis de cinza representada topograficamente.

\begin{figure}[ht]
   \centering
	\caption{Representação topográfica da figura \ref{fig:amostragem}. (a) Visualização pelo eixo x (b) Visualização pelo eixo z.}
    \subfigure[]{
        \includegraphics[width=0.455\hsize]{imagens/figura18x.png}
    }
    \hspace{3mm}
    \subfigure[]{
         \includegraphics[width=0.4\hsize]{imagens/figura18z.png}
    } \\
    Fonte: Imagens geradas com {\it MayaVi}.
   \label{fig:topografica}
\end{figure}

\section{Extremos Regionais}

Considerando uma imagem em níveis de cinza representada topograficamente, extremos regionais são pontos ou regiões planas tais que seus {\it pixels} vizinhos apresentam valores menores (máximos regionais) ou maiores (mínimos regionais) \cite{silva08}. Estas regiões normalmente representam áreas de interesse em imagens, utilizadas em processos de segmentação de regiões. Os extremos regionais de uma imagem em níveis de cinza qualquer podem ser visualizados na figura \ref{fig:extremos_regionais}. Na imagem, $M_{i}$, $i \in \{1, 2, 3, 4, 5, 6\}$ são os máximos regionais e $m_{j}$, $j \in \{1, 2, 3, 4, 5\}$ os mínimos regionais.

\begin{figure}[ht]
    \centering
	\caption{Extremos Regionais.}
    \includegraphics[scale=0.7]{imagens/figura19.png} \\
    Fonte: Imagem gerada pela autora.
    \label{fig:extremos_regionais}
\end{figure}

\section{Processamento e Análise de Imagens}

\citeonline{pedrini08} definem processamento de imagens como um conjunto de técnicas para captura, representação e transformação de imagens com o auxílio do computador. Desta forma, técnicas de processamento de imagens auxiliam na melhoria da qualidade de imagens bem como na extração e identificação de informações pertinentes a uma aplicação, a fim de auxiliar a percepção humana e a interpretação por máquinas. Enquanto processamento de imagens apresenta métodos de baixo nível como redução de ruído e aumento de contraste, a análise de imagens é considerada de alto nível, apresentando métodos de segmentação de regiões e reconhecimento ou classificação de objetos.

Segundo \citeonline{gonzalez00}, um sistema de processamento de imagens pode ser divido em etapas. A figura \ref{fig:pdi} ilustra essa divisão. A primeira etapa consiste na aquisição de uma imagem digital por meio de um dispositivo ou sensor, seguida da aplicação de técnicas de pré-processamento para melhorias na qualidade. O passo seguinte é a segmentação da imagem em regiões ou objetos de interesse e a representação destes para armazenamento e manipulação posteriores. A última etapa consiste em reconhecer, atribuindo um rótulo ao objeto, e interpretar, determinando significado aos objetos reconhecidos. Além destas etapas é importante a definição de uma base de conhecimento, representação do domínio do problema que auxilia na sua solução.

\begin{figure}[ht]
    \centering
	\caption{Etapas de um sistema de processamento de imagens.}
    \includegraphics[scale=1.0]{imagens/figura20.png} \\
    Fonte: Adaptado de \citeonline{gonzalez00}.
    \label{fig:pdi}
\end{figure}

\subsection{Limiarização}

A limiarização representa uma das principais formas de segmentação de imagens, ou seja, da separação entre objetos de interesse e o restante da imagem. Considerando uma imagem em níveis de cinza $f(x,y)$, define-se esta operação por meio da escolha de um valor $T$, dito limiar, o qual será comparado a cada {\it pixel} da imagem da seguinte forma \cite{gonzalez00}:

\begin{equation}
	g(x,y) = 
	\left\{ 
		\begin{array}{ll}
			1 \quad se \quad f(x,y) \quad \geq \quad T \\
		    0 \quad se \quad f(x,y) \quad < \quad T
	 	\end{array}
	\right.
\end{equation}  

Ou seja, caso o valor do ponto em análise for menor que o limiar, este receberá o valor $0$ (preto) na imagem resultante, enquanto que, para {\it pixels} os quais apresentam valor maior que o limiar, seus valores na imagem resultante serão $1$ (branco). Neste caso, no qual é definido apenas um valor de limiar, a limiarização é dita global, pois para toda a imagem apenas um valor de limiar é escolhido. Entretanto, há casos nos quais há a necessidade de definição de mais de um valor limiar, um para cada parte da imagem, seguindo a fórmula anterior e denominando limiarização local. Além desses dois conceitos, há um terceiro, denominado limiarização múltipla, quando são definidos dois limiares para uma imagem, o qual funciona da seguinte forma \cite{neves08}:

\begin{equation}
	g(x,y) = 
	\left\{ 
		\begin{array}{ll}
			1 \quad se \quad T_{1} \leq f(x,y) \leq T_{2} \\
		    0 \quad nos \quad demais \quad casos
	 	\end{array}
	\right.
\end{equation}

Ao final deste processo, uma imagem em preto ($0$) e branco ($1$), denominada binária, é criada.

\subsection{Convolução}

Convolução espacial é uma técnica de processamento de imagens utilizada na filtragem da imagem no domínio espacial. Aplicada no realce de altas, médias ou baixas frequências, este processo inicia pela definição de uma máscara de pesos, a qual irá se mover por todos os {\it pixels} da imagem, e o resultado da operação, para cada ponto, é armazenado em outra matriz de tamanho igual à entrada \cite{branco05}. Um exemplo de funcionamento da convolução espacial é apresentado na figura \ref{fig:convolucao}. Nela, tem-se uma imagem de entrada $f(x,y)$ na qual é transladada uma máscara de tamanho $3 \times 3$, de coeficientes $w(x,y)$, utilizada para o cálculo dos {\it pixels} da imagem resultante. Neste trabalho, o filtro de média (calcula a média de níveis de cinza da máscara sobre a imagem e a atribui ao {\it pixel} central) será utilizado em uma das técnicas desenvolvidas, a fim de amenizar os pontos de brilho.

\begin{figure}[ht]
    \centering
	\caption{Convolução espacial.}
    \includegraphics[scale=0.7]{imagens/convolucao.png} \\
    Fonte: \citeonline{adesso2012}
	\label{fig:convolucao}
\end{figure}

\subsection{Morfologia matemática}

A morfologia matemática, baseada na teoria de conjuntos, é uma metodologia utilizada para análise e manipulação de componentes de imagens, a fim de representar e descrever as formas das regiões \cite{gonzalez00}.

Segundo \citeonline{facon05}, seu princípio básico é a utilização de um elemento estruturante, considerado uma imagem menor em uma geometria conhecida, em comparação a uma imagem de entrada, a fim de extrair informações relativas à geometria e topologia desta. Assim, o elemento estruturante é transladado por toda a imagem de entrada, e a partir de seu formato é possível verificar a maneira como este elemento está ou não contido na imagem. A figura \ref{fig:elemento_estruturante} apresenta exemplos de elemento estruturante. As duas principais operações da morfologia matemática são consideradas a dilatação e a erosão, conceitos explicados a seguir.

\begin{figure}[ht]
	\centering
	\caption{Exemplos de elemento estruturante. (a) Caixa (b) Círculo (c) Cruz (d) Disco.}
    \subfigure[]{
        \includegraphics[scale=0.7]{imagens/box.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.53]{imagens/circle.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.53]{imagens/cruz.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.53]{imagens/disco.png}
    } \\
    Fonte: Imagens geradas pela autora.
   \label{fig:elemento_estruturante}
\end{figure}

\subsubsection{Dilatação e erosão}

Dilatação e erosão são as duas principais operações de morfologia matemática. Aplicadas em imagens em níveis de cinza, a primeira consiste na translação do elemento estruturante refletido na imagem, realizando o cálculo do máximo dos vizinhos a cada iteração, enquanto a segunda, seu complemento, calcula o mínimo dos vizinhos a cada translação. Em sua forma binária, entretanto, a dilatação representa o conjunto de translações nas quais há pelo menos um pixel não nulo do elemento estruturante sobreposto à parte não nula da imagem, enquanto a erosão é o conjunto de translações do elemento estruturante pela imagem, no qual o elemento está totalmente contido na imagem de entrada \cite{gonzalez00}. A figura \ref{fig:dilatacao_erosao} apresenta estas duas operações aplicadas a uma imagem binária.

\begin{figure}[ht]
	\centering
	\caption{Dilatação e erosão binárias. (a) Imagem de entrada (b) Dilatação (c) Erosão.}
    \subfigure[]{
        \includegraphics[scale=0.95]{imagens/figura37a.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.95]{imagens/figura37b.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.95]{imagens/figura37c.png}
    } \\
    Fonte: Imagens geradas pela autora.
   \label{fig:dilatacao_erosao}
\end{figure}

\subsubsection{Abertura e fechamento}

Abertura e fechamento são operações de morfologia binária que utilizam da dilatação e erosão vistas anteriormente. A abertura binária consiste na união das translações de um elemento estruturante contidas na imagem de entrada, enquanto o fechamento binário é considerado como a união das translações de um elemento estruturante que não estão contidas na imagem. Ou seja, a abertura pode ser considerada como a erosão de uma imagem (binária ou em níveis de cinza) por um elemento estruturante, seguida da dilatação deste resultado pelo mesmo elemento. Já o fechamento pode ser obtido pela dilatação da imagem por um elemento estruturante, seguida da erosão da imagem resultante por este mesmo elemento \cite{pedrini08}. Na figura \ref{fig:abertura_fechamento} é mostrado um exemplo destes dois operadores morfológicos aplicados em imagem binária.

\begin{figure}[ht]
	\centering
	\caption{Abertura e fechamento binários. (a) Imagem de entrada (b) Abertura (c) Fechamento.}
    \subfigure[]{
        \includegraphics[scale=0.95]{imagens/figura38a.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.95]{imagens/figura38b.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.95]{imagens/figura38c.png}
    } \\
    Fonte: Imagens geradas pela autora.
   \label{fig:abertura_fechamento}
\end{figure}

\subsubsection{Reconstrução morfológica}

A reconstrução morfológica binária de uma imagem, a partir de um marcador ou semente, consiste na seleção de regiões nas quais há interesecção com este marcador, a partir do tipo de conectividade (forma de ligação com a vizinhança) escolhida. O marcador utilizado será responsável pelos componentes extraídos da imagem. Aplicada à imagem em níveis de cinza, esta técnica consiste na união de componentes da decomposição por limiares \cite{silva11}, os quais apresentam intersecção com os componentes do marcador, também decompostos por limiares \cite{silva09}. Um exemplo de reconstrução morfológica aplicada a uma imagem em níveis de cinza é apresentada na figura \ref{fig:reconstrucao_morfologica}.

\begin{figure}[ht]
	\centering
	\caption{Exemplo de reconstrução morfológica em imagem em níveis de cinza a partir da máxima extinção de volume. (a) Entrada (b) Reconstrução.}
    \subfigure[]{
        \includegraphics[scale=0.6]{imagens/face_entrada.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.6]{imagens/face_reconstruida.png}
    } \\
   	Fonte: Imagens geradas pela autora.
   \label{fig:reconstrucao_morfologica}
\end{figure}

\subsubsection{Fechamento de buracos}

Baseado na reconstrução morfológica, o fechamento de buracos utiliza um marcador {\it frame}, definido com valores máximos ($1$ em imagens binárias e $255$ para imagens em níveis de cinza) nas primeiras e últimas linhas e colunas. Assim, esta técnica é aplicada no complemento (valor máximo menos o valor de cada pixel) da imagem de entrada, a fim de reconstruir as regiões que apresentam interface com os limites do domínio da imagem. Esta operação, portanto, remove vales (em forma de ilhas escuras) que não estão conectados à borda da imagem \cite{dougherty03}. A figura \ref{fig:fechamento_buracos} apresenta um exemplo de fechamento de buracos em níveis de cinza.

\begin{figure}[ht]
    \centering
	\caption{Fechamento de buracos em uma imagem em níveis de cinza. (a) Entrada (b) Fechamento de buracos.}
    \subfigure[]{
        \includegraphics[scale=0.8]{imagens/figura34a.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=0.8]{imagens/figura34b.png}
    } \\
   	Fonte: Imagens geradas pela autora.
   \label{fig:fechamento_buracos}
\end{figure}

\subsubsection{Tranformada de Distância}

A tranformada de distância, aplicada a uma imagem binária, consiste no cálculo das distâncias mínimas entre regiões ou pontos desta imagem e os {\it pixels} de fundo \cite{peixoto00}. Assim, a partir de uma métrica definida, calcula-se a distância de um ponto $x$, na imagem original, ao ponto mais próximo do complemento da imagem. Um exemplo de aplicação desta transformada é obtida pela figura \ref{fig:transformada_distancia}.

\begin{figure}[ht]
    \centering
	\caption{Exemplo de transformada de distância. (a) Imagem binária de entrada (b) Tranformada de distância da figura (a).}
    \subfigure[]{
        \includegraphics[scale=1.0]{imagens/entrada_transformada_distancia.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=1.0]{imagens/transformada_distancia.png}
    } \\
    Fonte: Imagens geradas pela autora.
    \label{fig:transformada_distancia}
\end{figure}

\subsubsection{Watershed}

De acordo com \citeonline{peccini02}, Watershed representa um dos principais métodos de segmentação por crescimento de regiões. Com base na representação topográfica de uma imagem em níveis de cinza, esta técnica é caracterizada pela inundação de relevos topográficos. Este trabalho utiliza a inundação de cima para baixo, ou seja, a partir de máximos regionais. Desta forma, conforme as bacias vão sendo inundadas, há o encontro de água de diferentes bacias, formando, nestes pontos, as denominadas linhas divisoras de água ({\it watersheds}).

Propõe-se neste trabalho a aplicação de Watershed sobre a imagem resultante da transformada de distância para obtenção do diagrama de Voronoi \cite{okabe09}. A figura \ref{fig:watershed_voronoi} apresenta um exemplo deste processo.

\begin{figure}[ht]
    \centering
	\caption{Diagrama de Voronoi obtido com Tranformada de Distância e Watershed (a) Transformada de Distância (b) Watershed aplicado à imagem (a), obtendo o Diagrama de Voronoi.}
    \subfigure[]{
        \includegraphics[scale=1.0]{imagens/transformada_distancia.png}
    }
    \hspace{1mm}
    \subfigure[]{
         \includegraphics[scale=1.0]{imagens/watershed_voronoi.png}
    } \\
   	Fonte: Imagens geradas pela autora.
   \label{fig:watershed_voronoi}
\end{figure}

\section{Reconhecimento de Padrões}

De acordo com \citeonline{gonzalez00}, um padrão é uma descrição quantitativa ou estrutural de um objeto ou entidade de interesse em uma imagem. Cada padrão pode ser representado por um descritor, normalmente em forma de vetor, cadeia ou árvore. Um conjunto de padrões que apresentam características ou propriedades semelhantes formam uma classe de padrões.

O reconhecimento ou classificação de padrões \cite{pedrini08} procura relacionar amostras de entrada a classes previamente rotuladas em um sistema, verificando uma amostra com características semelhantes a uma classe e rotulando-a com o mesmo identificador desta caso seja encontrada. As principais abordagens em reconhecimento de padrões aplicadas ao tema deste trabalho serão discutidas no seção 5.2. Neste trabalho, os padrões a serem reconhecidos são faces humanas.
