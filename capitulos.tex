

\chapter{Conceitos}
\label{cap:conceitos}

Para que se possa ter uma maior compreensão das vulnerabilidades de um sistema, primeiro
deve-se conhecer o mesmo. Para isso, nesse capítulo, os conceitos e definições básicas para
compreensão de como o ambiente \ac{LAMP} funciona são apresentados.


\section{LAMP}
\label{sec:lamp}

\ac{LAMP} é conjunto de soluções em forma de uma lista dos componentes centrais usados na
implementação de uma aplicação web. Seu uso é predominante entre pequenas e médias empresas,
já que tais componentes são de código aberto e não têm custo. \ac{LAMP} pode ser definido pelo seus componentes, sendo eles:
\textbf{L}inux (sistema operacional), \textbf{A}pache (serividor web), \textbf{M}ySQL(software de banco de dados)
e \textbf{P}HP (linguagem de programação), que também pode se referir a Perl ou Python, apesar
de não ser muito comum \cite{RouseLamp} (mais detalhes na Seção \ref{sec:componentes}).

Um exemplo do funcionamento de cada componente do \ac{LAMP}, em um servidor \textit{web}, se dá por
um visitante entrando em um \textit{site} pelo seu navegador, o qual irá enviar um pedido para o servidor,
no qual todos os componentes \ac{LAMP} estão instalados e sendo executados. Este servidor pode então prover
ao usuário, interação com banco de dados através de \textit{scripts} \ac{PHP} através de formulários enviados
ao navegador pelo protocolo \ac{HTTP} \cite{BrownFuncionamento}. Essa combinação de softwares de código aberto
em todas as etapas do precesso dá ao \ac{LAMP} a confiabilidade e o baixo custo que fez com que ele se popularizasse.
A forma que essa popularização ocorreu pode ser vista na Seção a seguir. 


\subsection{HISTÓRICO}
\label{subsec:historico}

O conceito principal em volta do \ac{LAMP} (um servidor \textit{web} sem custo) foi possível no início de
1995 quando a \ac{CERN} introduziu o conceito de \ac{CGI}, que tornou possível aos servidores
executar códigos para criar páginas dinâmicas \cite{CGI:online}. Linux, \ac{CERN} httpd e linguagens de programação do lado do servidor
como Perl estavam disponíveis gratuitamente, mas conseguir um banco de dados gratuito
só foi possível mais tarde, com o lançamento de Postgre95 \cite{PostgreeHistorico}.

Ainda em meados de 1995, o servidor \ac{HTTP} Apache e \ac{PHP} foram lançados, compondo então o conjunto de aplicações \ac{LAPP}.
Finalmente em 1996, MySQL foi lançado e, com ele, o conjunto \ac{LAMP} completo fez-se possível. A popularidade do \ac{LAMP}
cresceu rapidamente nos anos 90, já que muitas empresas, por razões monetárias, utilizavam \textit{softwares} de código aberto
em suas páginas \textit{web} \cite{GeipelEmpresas}. Essa popularidade inicial contribuiu para que o LAMP fosse amplamente utilizado. Assim, se uma
falha é encontrada nele, uma grande quantidade de usuários são afetados.


\subsection{APLICABILIDADE}
\label{subsec:aplicabilidade}

Sistemas \ac{LAMP} podem ser encontrados em diversos níveis de aplicações. Quem utiliza um sistema operacional com kernel Linux em seu computador pessoal
e deseja desenvolver uma aplicação \textit{web}
pode fazê-la através da instalação dos componentes faltantes, ou seja, o Apache como servidor \ac{HTTP}, MySQL como banco de dados local e \ac{PHP} como linguagem de \textit{script}
de servidor local. Após essas configurações, o sistema está pronto para exibir \textit{web sites} criados localmente, os quais poderão conter formulários a 
serem processados e enviados
a outro servidor ou armazenados na própria máquina. Com o ajuste de alguns detalhes (configurações de \textit{firewall} e permissões), este \textit{site} desenvolvido localmente
pode se tornar acessível à usuários externos, fazendo com que o sistema se assemelhe à um servidor contratado.

Não se limitando a projetos de desenvolvimento local, o \ac{LAMP} se encontra frequentemente em servidores providos por \ac{InP}s, nos quais a principal
diferença de um sistema local
é a falta de interface gráfica, para alguns usuários experientes isso não é um problema e então a instalação dos componentes se dá de forma muito parecida,
através de linhas de comando.

\section{FUNCIONAMENTO E COMPONENTES BÁSICOS}
\label{sec:componentes}

Para garantir o bom funcionamento do sistema, é necessário a boa comunicação e integração entre todos os componentes do \ac{LAMP}.
Apesar de serem serviços independentes, juntos eles constituem um servidor \textit{web} capaz de executar \textit{scripts} (do lado do servidor) 
e armazenar dados. Detalhes dos componentes do sistema são descritos nas seções \ref{subsec:linux} à \ref{subsec:php}.

\subsection{Linux}
\label{subsec:linux}

Linux é o \textit{kernel} atuante como base de diversos \ac{SO}s de software livre, tais como Arch, Fedora, Debian e outros. 
Como \textit{kernel} de diversas distribuições, o Linux é o núcleo do \ac{SO} atuando em baixo nível, permitindo o bom gerenciamento 
do \ac{SO} sobre o \textit{hardware} \cite{kernel:online}.

Desde sua origem em 1991, sistemas Linux vem crescendo e ganhando
uma grande força na computação, atualmente presente em lugares desde a bolsa
de valores de Nova York e supercomputadores  à telefones celulares e computadores
pessoais, o Linux é um software livre desenvolvido de maneira
colaborativa \cite{WhatI30:online}. Mais de 1.000 desenvolvedores
de pelo menos 100 diferentes companhias, contribuíram para cada
versão do \textit{kernel} sob a licensa \ac{GPL} que é baseada em quatro
liberdades \cite{Whati7:online}:

\begin{itemize}
 \item A liberdade de executar o programa como quiser, para qualquer propósito;
 \item A liberdade para estudar como o programa funciona, e alterá-lo para que ele execute como você queira. Ter acesso ao código fonte é necessário para tal;
 \item A liberdade para redistribuir cópias para ajudar o próximo; e
 \item A liberdade para distribuir cópias de suas versões modificadas para outros. Fazendo isso você concede à comunidade a chance de se beneficiarem de suas alterações. Ter acesso ao código fonte é necessário para tal.
\end{itemize}

Por esses motivos o Linux tem sido bem-sucedido, particularmente como plataforma de servidor: 
até mesmo em organizações que confiam veemente em sistemas operacionais
comerciais como Microsoft Windows, o Linux aparece frequentemente em papeis infraestruturais, como em \textit{gateways} de \ac{SMTP} e servidores \ac{DNS}
devido a sua confiança, segurança, baixo custo e a qualidade execepcional das aplicações do servidor \cite{bauer2005linux}.

No acrônimo \ac{LAMP} o componente Linux é o primeiro a aparecer. Sendo a base do sistema, todos os outros componentes (Apache, MySQL e PHP) são executados
sob \textit{kernel} Linux, constituindo assim um serviço gratuito disponibilizado através da integração de um conjunto de \textit{softwares} livres.

\subsection{Apache}
\label{subsec:apache}

Atuando como servidor \ac{HTTP} no sistema \ac{LAMP}, o Apache é o servidor \textit{web}
mais popular na Internet desde Abril de 1996 \cite{http:apache}.
O Apache é um projeto de código livre (sob a licensa \ac{GPL}) da \ac{ASP}, o qual tem como 
objetivo manter um seguro, eficiente e extensível servidor que provê
serviços \ac{HTTP} de acordo com os padrões \ac{HTTP} atuais.

Como segundo componente do acrônimo LAMP, o servidor Apache é o provedor de serviços \ac{HTTP}. Sendo capaz de aceitar requisições \ac{HTTP}, é este componente 
o responsável por responder ao \textit{browser} uma requisição de página \textit{web}, por exemplo. Solicitações também podem ser efetuadas através de execuções de
\textit{scripts} \ac{PHP}. 

Páginas mais complexas, consequentemente, são resultados de sistemas mais complexos. A busca e amostragem de dados em uma 
página \textit{web} não se dá pelo retorno imediato do servidor à aplicação solicitante, dependendo também da execução de um \textit{script} 
solicitando um certo conjunto de dados ao banco de dados local através de consultas em
\ac{SQL} executadas pelo \ac{SGBD} MySQL, terceiro componente do acrônimo.


\subsection{MySQL}
\label{subsec:mysql}

O \ac{BD} MySQL, foi projetado com base no mSQL, o qual tinha muitos problemas, como 
não ser rápido e flexível o suficiente para o uso dos usuários \cite{MySQL14:online}, com isso a necessidade
de um novo \ac{BD} foi aumentando e com base nesse conceito foi desenvolvido o que
hoje é conhecido como MySQL, um \ac{SGBD} que viabiliza programação em \ac{SQL} presente no servidor \ac{LAMP}, 
o qual se comunica com perfeição com a linguagem de programação presente no \ac{LAMP} (PHP), com isso 
veio a ser adotado como principal \ac{BD} nos servidores.

Um \ac{BD} pode ser definido como uma coleção de dados, para conseguir acessar
os dados armazenados nesse sistema, teve-se a necessidade de criar algum tipo de gerenciador,
sendo o MySQL um dos mais usados. Algumas características desse sistema \cite{MySQL69:online}:

\begin{itemize}
 \item \textbf{Banco de dados relacional:} a principal diferença desse tipo de \ac{BD} para os outros
 é que os dados são guardados em pequenas tabelas de uma forma que seu acesso seja da forma mais eficiente
 o possível, obtendo um tempo menor de resposta com o servidor e com isso passou a ganhar espaço no mercado.
 \item \textbf{\textit{Open Source:}} esse termo corresponde que qualquer pessoa pode modificar o 
 \textit{software} do jeito que preferir, podendo ajustá-lo conforme a sua necessidade, sendo perfeito
 para programadores experientes que precisam adaptá-los a seus critérios.
 \item \textbf{Rápido, confiável, escalável e fácil de usar:} como foi criado para atender a grandes
 quantidades de dados de uma forma mais rápida que seus concorrentes, foi apenas lógico que se tornasse
 um dos mais rápidos \ac{BD}. Portanto começou a ser utilizado em grande escala, consequentemente a 
 segurança foi aumentando juntamente com sua escalabilidade para atender a demanda de usuários. 
\end{itemize}

Mesmo com a segurança presente, precisamos ainda tomar algumas atitudes para 
dificultar que o \ac{BD} seja acessado por pessoas não autorizadas. Alguns métodos básicos que 
ajudam a proteger seu \ac{BD} \cite{MySQL10:online}:

\begin{itemize}
 \item Não prover acesso a ninguém para a tabela usuário do \ac{BD} MySQL.
 \item Não guardar senhas sem algum tipo de função \textit{hash} (algoritmo usado para transformar 
 sua senha para uma \textit{string} ilegível.
 \item Crie senhas aleátorias, porém de fácil memorização.
 \item Invista em um \textit{firewall}, protegem pelo menos 50\% dos ataques feitos contra seu \textit{software}.
 \item Sempre criptografe os dados que precisam ser enviados pela internet.
\end{itemize}

Portanto, seguindo algumas boas práticas de segurança relativamente simples, têm-se um \ac{BD} protegido e qualquer
pessoa não autorizada não poderá acessá-lo.

\subsection{PHP}
\label{subsec:php}

O \ac{PHP} foi criado em 1994 por Rasmus Lerdof, o projeto inicial era um simples conjunto de \ac{CGI}s\footnote{Uma maneira padrão para um servidor \textit{web} passar a
solitação do usuário para uma aplicação e receber dados para enviar ao usuário.} binários escritos na linguagem de
programação C, usados para rastrear as visitas ao seu \textit{site}\cite{PHP:H3:online}. Com o tempo, otimizações foram sendo feitas e funcionalidades adicionadas.
Sendo lançado em 1998, o \ac{PHP} 3.0 foi a primeira versão que contém traços do \ac{PHP} de hoje em dia, incluindo o suporte a programação orientada a
objeto. Porém essa versão tinha muita dificuldade em processar aplicações complexas, foi com base nessa premissa que foram lançadas as versões 4.0
e 5.0 (Julho de 2004), principalmente para melhorar seu antecessor e acrescentar dezenas de novos recursos.

Usado principalmente para desenvolvimento \textit{web}, é um \textit{script open source} de uso geral. As principais áreas que 
\textit{scripts} \ac{PHP} são mais utilizados \cite{PHP:O35:online}:
\begin{itemize}
 \item \textbf{Scripts no lado do servidor.} Podendo acessar os resultados do seu programa com um navegador web.
 \item \textbf{Scripts de linha de comando.} Executar os scripts sem um servidor ou navegador, apenas necessita de um interpretador PHP.
 \item \textbf{Escrever aplicações desktop.} Não é a melhor linguagem para se desenvolver aplicações desktop, porém para um programador experiente o PHP tem alguns recursos
 avançados que permitem escrever esse sistema.
\end{itemize}

Com as características destacadas acima, pode-se perceber o quão viável o \ac{PHP} é como linguagem de programação dos servidores \ac{LAMP}, sendo principalmente
por seus \textit{scripts} no lado do servidor, os quais retornam informações de uma forma rápida, eficiente e de fácil acesso.

Uma característica é a escalabilidade que o \ac{PHP} possui, podendo ser utilizado na maioria
dos sistemas operacionais e servidores \textit{web} \cite{ongoi15:online}. Portanto, pelas características descrita, ele vem sendo aplicado cada
vez mais em servidores LAMP, por suas várias extensões que facilitam a conectividade com diversos banco de dados e sua fácil integração com servidores \textit{web}. 
Logo, observa-se o porquê do \ac{PHP} ser aplicado em tantas aplicações, seja por seu fácil entendimento, sua maneira simples de programar ou até mesmo sua eficiente
integração com os demais componentes do \ac{LAMP}.


\section{FUNDAMENTAÇÃO DE ATAQUES E SOLUÇÕES}
\label{sec:fundamentos}

Testes de penetração de servidores \textit{web} não devem ser confundidos com ataques maliciosos. Apesar de possuírem rotinas 
parecidas, possuem objetivos distintos. Ataques maliciosos são realizados para roubar informações, causar indisponibilidade de serviços
(\ac{DoS}) ou qualquer outro evento indesejado ao responsável pelo servidor. Já um teste de penetração consiste em um processo 
autorizado, programado e sistemático onde se faz uso de vulnerabilidades conhecidas para realizar tentativas de invasão a um servidor,
rede ou conteúdos de aplicações.

Testes de penetração podem ser executados de mais de uma maneira para propor mais de um ponto de vista sob a mesma organização. 
Para tal, existem dois tipos de testes (não exclusivos) que podem ser conduzidos \cite{sans:2002}:

\begin{description}
      \item[Teste  interno de penetração] Realizado com o objetivo de identificar vulnerabilidades com acesso
      físico ou exposição a engenharia social. Servem para determinar quais vulnerabilidades existem no sistema interno, 
      acessível somente à pessoas autorizadas com acesso a rede interna da organização.

      \item[Teste externo de penetração] Realizado com o objetivo de identificar vulnerabilidades presentes através de
      conexões que foram estabelecidas através da conexão entre a organização e a Internet (através do \textit{firewall} ou \textit{gateway}).
\end{description}

Testes de penetração são um método de segurança ofensiva, na qual ocorre a reprodução de uma tentativa real de invasão para que assim sejam identificadas
vulnerabilidades na segurança do sistema. Para a execução dos testes existem ferramentas (ou \textit{frameworks}) com configurações predefinidas para auxiliar no decorrer
do processo.

\section{FRAMEWORKS E SOLUÇÕES PARA ANÁLISE DE VULNERABILIDADES}
\label{sec:frameworks}
\textit{Frameworks} para análise de vulnerabilidades são ferramentas para facilitar a detecção de vulnerabilidades em determinado 
sistema/página \textit{web}, também conseguindo prever a efetividade das medidas tomadas para combater as vulnerabilidades encontradas
pelos frameworks. Porém, para se obter a máxima eficiência destas ferramentas, precisa-se seguir alguns passos para a
análise de vulnerabilidades \cite{Vulne27:online}:

\begin{itemize}
 \item \textbf{Conduzir avaliação:} consiste em dois objetivos principais, 
o de planejamento (coletar informações, definir escopo) e o método de 
aplicar a análise de vulnerabilidades (entrevistar administradores e escanear a segurança.)
 \item \textbf{Identificar exposições:} revisar os dados coletados na fase anterior
e classificá-los de acordo com seu nível de perigo, e assim propor soluções.
 \item \textbf{Endereçar exposições:} tentar resolver as exposições identificadas
na fase anterior.
\end{itemize}

Uma dessas ferramentas é o \textit{Nikto}, o qual é uma ferramenta de segurança específica para \textit{websites}, podendo verificar:
mais de 6.000 ameaças em potencial localizadas em arquivos ou programas, mais de 1.200 versões desatualizadas de servidores
 e mais de 270 problemas em servidores específicos \cite{Nikto57:online}. Alguns dos principais problemas frequentemente detectados
são: arquivos perigosos, serviços mal configurados, \textit{scripts} vulneráveis, entre outros.

Outra ferramenta que pode ser citada é o \textit{Vega}, com objetivos semelhantes ao \textit{Nikto}, 
porém com dois modos de operação \cite{About78:online}: 

\begin{itemize}
 \item \textbf{\textit{Scanner} automático:} rastreia automaticamente por \textit{websites}, extraindo \textit{links},
 e executa módulos em possíveis pontos de vulnerabilidades.
 \item \textbf{\textit{Proxy} de interceptação:} permite análises detalhadas sobre a interação navegador-aplicação.
\end{itemize}

Pode-se citar ainda o OpenVAS, uma ferramenta para varredura e gerenciamento de vulnerabilidades. Podendo ser subdividido em duas
arquiteturas \cite{OpenV32:online}:

\begin{description}
 \item [Rastreados OpenVAS] executa os testes de vulnerabilidades.
 \item [Gerenciador OpenVAS] consolida a varredura de vulnerabilidade em uma solução completa de gerenciamento de vulnerabilidade.
\end{description}



\section{NORMAS, RECOMENDAÇÕES E BOAS PRÁTICAS PARA ANÁLISE DE VULNERABILIDADES}
\label{sec:normas}


Vulnerabilidade pode ser definida como um erro no \textit{software} que permite que uma pessoa não autorizada ganhe acesso ao sistema
ou a rede interna \cite{CVE-F22:online}. Primeiro monitora-se
com qual frequência determinada vulnerabilidade pode ocorrer, e o quão prejudicial é para o programa.
Quando é descoberto alguma vulnerabilidade com os testes realizados,
ocorre a verificação em um banco de dados de vulnerabilidades, sendo o \ac{CVE} uma boa fonte para conhecer 
um pouco mais sobre o problema encontrado. 

Existem também os escaneadores de vulnerabilidade, os quais são \textit{softwares} que ajudam na identificação de possíveis
problemas que podem facilitar a corrupção do 
sistema, identificando, como por exemplo: versões de \textit{softwares} desatualizadas, configurações falhas. Segundo \cite{NIST:online},
esses escaneadores podem:

\begin{itemize}
 \item \textbf{Verificar políticas de segurança.}
 \item \textbf{Prover informações sobre alvos para testes de penetração.}
 \item \textbf{Fornecer informações sobre como diminuir as vulnerabilidades descobertas.}
\end{itemize}

Contudo, esses escaneadores atuam de forma local. Ao identificar de maneira isolada cada falha e vulnerabilidade
muitas vezes não passam a proporção real do problema, que se daria em um único contexto com todas as falhas identificadas. Ou seja,
várias pequenas vulnerabilidades podem, juntas, proporcionar um grande risco ao servidor.

Outro meio de se prevenir contra ataques pode ser feito com uma simples revisão dos códigos fontes quando estes estão sendo implementados,
não apenas nos seus estados finais. Também é viável realizar 
testes unitários para verificar sua consistência.


\chapter{LAMP \& KALI}
\label{lampkali}

Neste capítulo será apresentado as principais vulnerabilidades em sistemas \ac{LAMP}, bem como os principais ataques realizados. Estes 
ataques/vulnerabilidades serão analisadas com a ajuda do sistema operacional KALI, baseada em distribuição Linux, o qual é especializado em realizar
testes de intrusão. Portanto, algumas ferramentas serão descritas e futuramente usadas para a realização de testes.

\section{LAMP}



\subsection{VULNERABILIDADES}
\subsubsection{Ameaças em potencial}
\subsection{MÉTODOS DE EXPLORAÇÃO}



\subsection{PRINCIPAIS ATAQUES}
\label{principaisataques}

Ataques direcionados a servidores baseados em \ac{LAMP} tem como objetivo explorar as vulnerabilidades das aplicações. Geralmente ataques são confundidos com vulnerabilidades, porém
os mesmos não são sinônimos, ataque é algo que o atacante realiza e não uma falha do sistema. Alguns dos principais ataques serão apresentados, bem como sua descrição e os problemas
que são causados caso o sistema seja afetado por esses ataques.

\subsubsection{SQL Injection}

Um dos principais ataques é conhecido como \ac{SQL} \textit{injection}, o qual consiste em inserir uma consulta \ac{SQL} do cliente para a aplicação. Se o ataque for bem-sucedido 
o atacante conseguirá acessar e modificar informações do \ac{BD}, o qual guarda todos os dados referentes ao sistema, com isso pode-se arruinar todo a aplicação.

Portanto, as consequências são graves. Pode-se citar algumas delas quando o sistema for comprometido \cite{SQLIn46:online}, como:

\begin{itemize}
 \item \textbf{Confidenciabilidade:} como os \ac{BD} guardam informações sobre tudo, perca de confidenciabilidade é um problema frequente.
 \item \textbf{Autenticação:} se os comandos \ac{SQL} que são usados para verificar senhas são mal escritos, há a possibilidade do atacante se conectar ao sistema como outro usuário.
 \item \textbf{Autorização:} se a informação de autorização está no \ac{BD}, então é possível que o atacante mude essa informação a ser favor.
 \item \textbf{Integridade:} se é possível a leitura de informações restristas, então o atacante também conseguirá mudar ou até mesmo deletar informações com o ataque de \ac{SQL} \textit{injection}.
\end{itemize}

Com isso, percebe-se o grave prejuízo do sistema vulnerável ao ataque de \ac{SQL} \textit{injection}, com perdas de informações importantes e até mesmo o comprometimento total do sistema
uma vez que o atacante tem acesso ao \ac{BD} da aplicação.

\begin{figure}[H]
\centering
\includegraphics[width=0.7\textwidth]{imagens/sql-injection.png}
\caption{Como é um ataque de \ac{SQL} Injection. Fonte: owasp.org}
\label{fig:sql-injection}
\end{figure}

Na fig.~\ref{fig:sql-injection} têm-se como os atacantes conseguem se infiltrar no sistema e assim roubar dados dos usuários.

\subsubsection{Cross-site Scripting (XSS)}

Outra vulnerabilidade utilizada pelos atacantes para conseguir infiltrar em seu sistema é o Cross-site Scripting. Sendo que o atacante pode injetar \textit{scripts} maliciosos 
dentro de seu sistema e conseguir com que o \textit{browser} execute esse script por parte do cliente (\textit{client-side script}). Um exemplo deste tipo de ataque pode ser vista em 
uma página qualquer que possui campo de login e senha, sendo estes dados, quando inseridos pelos usuários, enviados a um \ac{BD} e assim o atacando consegue visualizar o login e senha do 
usuário.

Um ataque pode ser caracterizado como \ac{XSS} segundo \cite{Cross69:online} quando:

\begin{itemize}
 \item Dados entram na aplicação \textit{Web} por uma fonte de dado não confiável, geralmente por uma requisição \textit{web}.
 \item Os dados que são incluídos em contexto dinâmico e que foram enviados por um usuário sem que tenha sido validado para conteúdo malicioso.
\end{itemize}

Muitas vezes atacantes utilizam de códigos JavaScript para conseguirem se infiltrar em sistemas com vulnerabilidade e assim roubar dados de usuários e até mesmo dos própios 
proprietários do sistema.

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/Diagram-Describing-Blind-XSS-Attack.png}
\caption{Como é realizado um ataque \ac{XSS}. Fonte: acunetix.com}
\label{fig:XSS}
\end{figure}

Na fig.~\ref{fig:XSS} têm-se um exemplo da arquitetura de um ataque \ac{XSS}.


\section{KALI}

O sistema operacional KALI Linux é uma distribuição Linux especializada em testes de intrusão. Com isso, o sistema possui muitas funcionalidades para que possa 
ser um dos melhores sistemas para a realização de testes de penetração \cite{Whati87:online}, como:

\begin{itemize}
 \item \textbf{Mais de 600 ferramentas para testes de penetrações.}
 \item \textbf{\textit{Open source} e gratuito.}
 \item \textbf{Desenvolvido por um pequeno grupo, utilizando protocolos seguros.}
 \item \textbf{Suporte a múltiplos idiomas.}
 \item \textbf{Completamente customizável.}
\end{itemize}

Com todas essas características percebe-se o quão poderoso o Kali Linux pode ser quando utilizado por pessoas que necessitam realizar testes de penetração. Porém, como o sistema
foi desenvolvido para necessidades específicas, usuários que não conhecem/utilizam distribuições Linux podem ter dificuldades com relação as ferramentas, pois mesmo ele sendo 
\textit{open source} não são todos os usuários que podem contribuir para o seu desenvolvimento (questões de segurança).


\subsection{FERRAMENTAS PARA ANÁLISE DO LAMP}
\label{ferramentas}

Ferramentas para análise do \ac{LAMP} são acessórios que facilitam ao se procurar por vulnerabilidades. Nesta seção apresentar-se-á algumas dessas ferramentas, descrevendo-as 
e informando algumas características específicas, todas as ferramentas aqui apresentadas estão disponibilizadas sem custo e nativamente quando instalado o sistema operacional 
Kali Linux.

\subsubsection{Vega}

Uma ferramenta que será utilizada para a análise do \ac{LAMP} será o \textit{Vega}, o qual é gratuito e \textit{open source}, sua especialidade consiste em análise de vulnerabilidade
em servidores \textit{web}. Neste acessório têm-se incluido um escaneador automático, o qual possui a função de realizar testes rápidos, as vulnerabilidades que o \textit{Vega} pode 
encontrar: XSS (\textit{cross-site scripting}, SQL injection, dentre outras \cite{Vega9:online, VegaV22:online}.

Algumas características que esta ferramenta apresenta:

\begin{itemize}
 \item \textbf{Escaneador automático.}
 \item \textbf{Interceptador de \textit{proxy}.}
 \item \textbf{Escaneador de \textit{proxy}.}
\end{itemize}

Portanto, percebe-se que caso o objetivo seja procurar por vulnerabilidades em relação a \textit{websites} utilizando \ac{LAMP}, o \textit{Vega} é uma ferramenta
simples, fácil de usar e que cumpre seu objetivo com perfeição.

\subsubsection{sqlmap}

Outra ferramenta que será utilizada para testes e posteriormente apresentado resultados na seção \label{ataques} será o \textit{sqlmap}, o qual é uma ferramenta \textit{open source}
especializada em \ac{SQL} injection e que automatiza o processo de detecção e exploração. Segundo \cite{sqlma32:online}, esta ferramenta possui algumas 
funcionalidades/características:

\begin{itemize}
 \item Suporte para diferentes Banco de Dados.
 \item Suporte para diferentes técnicas de \ac{SQL} \textit{injection}.
 \item Suporte para enumerar usuários, \textit{password hashes}, tabelas e colunas do \ac{BD}.
 \item Suporte para derrubar tabelas do \ac{BD}.
\end{itemize}

Entretanto, mesmo com esta ferramenta proporcionando várias funcionalidades, necessita-se de um bom conhecimento para a realização de um ataque. 

\subsubsection{XSSer}

Uma ferramenta que pode facilitar na hora de realizar ataques de \ac{XSS} é a ferramenta XSSer, a qual é automizada para detectar, explorar e reportar vulnerabilidades de \ac{XSS} em 
aplicações \textit{web}. Para utilizar desta ferramenta é necessário ter a linguagem Python instalada e algumas bibliotecas específicas.

Na figura \ref{fig:xsser} têm-se um exemplo do funcionamento da ferramenta XSSer.

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/Xsser-url-schema.png}
\caption{Exemplo de funcionamento do XSSer. Fonte: owasp.org}
\label{fig:xsser}
\end{figure}

\subsection{TÉCNICAS X MÉTODOS X FERRAMENTAS}

Técnicas, métodos e ferramentas se trabalhados em conjunto conseguem realizar até os mais minuciosos testes de vulnerabilidades e consequentemente verificar e possivelmente 
corrigir os problemas apresentados. Porém, integrar estes três pode ser uma tarefa bastante complexa, sendo necessário a experiência de quem ficará responsável pelo monitoramente e a 
realização de testes de penetração das aplicações \ac{LAMP}.

Se vistos de forma separados, técnica pode ser dita como a experiência do atacante, representando como o ataque irá ser realizado, já método pode ser visto como qual será o ataque 
a ser realizado, e ferramenta como um facilitador para que o atacante consiga acessar sua aplicação de forma ilegal. Portanto, percebe-se que não pode faltar nenhum desses componentes 
para que haja um aproveitamento máximo dos testes de penetração.


\chapter{ATAQUES E ANÁLISE}
\label{ataques}

Neste capítulo será apresentado os ataques realizados e algumas análises dos mesmos, bem como possíveis soluções para os problemas encontrados. Para a realização dos ataques será 
utilizado algumas ferramentas auxiliares, como: \textit{Vega}, \textit{sqlmap} e \textit{XSSer} (ver seção~\ref{lampkali} para mais detalhes).

\section{AMBIENTE DE TESTES E PLANO DE TESTES}

Todos os testes aqui apresentados foram executados em \textit{sites} próprios para testes de penetração, ou seja, são \textit{sites} próprios para que sejam feitos os devidos 
testes e com isso aprimorar habilidades sem nenhum tipo de dano a terceiros. Estes \textit{sites} são disponibilizados pela \cite{OWASP38:online},
são eles: \url{www.testphp.vulnweb.com} e \url{www.hackthissite.org}.

Também foram realizados testes com auxílio de ferramentas específicas para cada tipo de ataque (comentado em \ref{principaisataques}). 


\section{SESSÃO DE ATAQUES}\label{sec:attack}

Viabilizada por ferramentas \textit{open-source} já citadas em \ref{ferramentas}, a sessão de ataques seguiu a seguinte ordem lógica: 
\begin{enumerate}
 \item Análise das vulnerabilidades com o \textit{Vega};
 \item Utilização do \textit{sqlmap} para execução de \textit{SQL Injection}; e
 \item Utilização do \textit{XSSer} para execução de \textit{Cross Site Scripting}.
\end{enumerate}

\subsection{Análise de Vulnerabilidade com \textit{Vega}}

As figuras \ref{fig:vega_hack} e \ref{fig:vega_acuart} representam as vulnerabilidades encontradas quando utilizado do \textit{Vega Scan}
(ver \ref{ferramentas} para mais detalhes).

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/vegascan_hackthissite.png}
\caption{Vulnerabilidades do site: hackthissite.org. Fonte: Próprio autor}
\label{fig:vega_hack}
\end{figure}

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/vegascan_acuart.png}
\caption{Vulnerabilidades do site: testphp.vulnweb.com. Fonte: Próprio autor}
\label{fig:vega_acuart}
\end{figure}

O \textit{Vega} realiza então a classificação das ameaças como sendo de risco alto, médio ou baixo. Tendo então detectado um total de 
1535 ameaças em \url{www.hackthissite.org} e 54 ameaças em \url{www.testphp.vulnweb.com}.

\subsection{Ataques de \textit{SQL Injection}}\label{subsec:sql_injection}

De acordo com a análise do \textit{Vega} dentre as 54 ameaças encontradas em \url{www.testphp.vulnweb.com} (figura \ref{fig:vega_acuart})
existem 7 possíveis endereços vulneráveis à \textit{SQL Injection} e um dos possíveis endereços pode ser visualizado na figura 
\ref{fig:vega_sqlinjection_acuart}.

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/vegascan_sqlinjection_acuart.png}
\caption{Endereço vulnerável em testphp.vulnweb.com. Fonte: Próprio autor}
\label{fig:vega_sqlinjection_acuart}
\end{figure}

Após obter através do \textit{Vega} o endereço onde será realizado o ataque, o próximo passo fora a utilização do \textit{sqlmap}
para obter inicialmente o nome dos bancos de dados disponíveis.

\begin{lstlisting}[caption={Comando para retornar a lista de bancos disponíveis},label={lst:db_disponivel},style=BashInputStyle]
    $ sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1%20AND%201=2%20--%20
    --dbs --threads 3
\end{lstlisting}

Com o comando \ref{lst:db_disponivel} é possível obter a lista dos bancos de dados, como visto na figura \ref{fig:sqlmap_dbnames}.


\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/sqlmap_dbnames_acuart.png}
\caption{Nome dos \ac{BD}. Fonte: Próprio autor}
\label{fig:sqlmap_dbnames}
\end{figure}

Dentre os nomes identificados tem-se o banco \textit{information\_schema}, o qual costuma ser um banco de dados padrão do sistema. Logo, o foco
dos ataques será o banco \textit{acuart}. Para isso executa-se então o comando \ref{lst:tables}.

\begin{lstlisting}[caption={Comando para retornar a lista de tabelas},label={lst:tables},style=BashInputStyle]
    $ sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1%20AND%201=2%20--%20
    --tables --threads 3
\end{lstlisting}

A figura \ref{fig:sqlmap_tablenames2} exemplifica o retorno da operação realizada.


\begin{figure}[H]
\centering
\includegraphics[width=0.4\textwidth]{imagens/sqlmap_tablenames2_acuart.png}
\caption{Nome das tabelas no \ac{BD}. Fonte: Próprio autor}
\label{fig:sqlmap_tablenames2}
\end{figure}

Tendo então o nome das tabelas, é possível adicionar mais parâmetros ao comando \textit{sqlmap} para obter as colunas de uma determinada tabela,
por exemplo. Simulando um sistema onde o banco de dados possui usuários cadastrados, é possível visualizar o nome \textit{users}, uma tabela
promissora para conter o nome de usuário e senha para um possível \textit{login}.


\begin{lstlisting}[caption={Comando para retornar as colunas da tabela users},label={lst:columns},style=BashInputStyle]
    $ sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1%20AND%201=2%20--%20
    -D acuart -T users --columns
\end{lstlisting}

Verificar os campos (colunas) dessa tabela com \textit{sqlmap} é fácil com o comando \ref{lst:columns}, sendo o resultado apresentado 
na figura \ref{fig:sqlmap_columnsnames}.

\begin{figure}[H]
\centering
\includegraphics[width=0.3\textwidth]{imagens/sqlmap_columnsnames_acuart.png}
\caption{Nome das colunas de um \ac{BD}. Fonte: Próprio autor}
\label{fig:sqlmap_columnsnames}
\end{figure}

Neste retorno observa-se os campos \textit{uname} e \textit{pass}, os quais provavelmente contém nome de usuário e senha para acesso ao perfil
do usuário.

Para verificar estes valores tem-se os comandos \ref{lst:dump_uname} e \ref{lst:dump_pass}. O retorno desses comandos estão expostos nas figuras
\ref{fig:dump_uname} e \ref{fig:dump_pass} respectivamente.

\begin{lstlisting}[caption={Comando para retornar os valores da coluna \textit{uname}},label={lst:dump_uname},style=BashInputStyle]
    $ sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1%20AND%201=2%20--%20
    --threads 3 -D acuart -T users -C uname --dump
\end{lstlisting}

\begin{lstlisting}[caption={Comando para retornar os valores da coluna \textit{pass}},label={lst:dump_pass},style=BashInputStyle]
    $ sqlmap -u http://testphp.vulnweb.com/artists.php?artist=1%20AND%201=2%20--%20
    --threads 3 -D acuart -T users -C pass --dump
\end{lstlisting}


\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/sqlmap_uname_acuart.png}
\caption{\textit{Dump} do campo \textit{uname} da tabela \textit{users} com \textit{sqlmap}. Fonte: Próprio autor}
\label{fig:dump_uname}
\end{figure}


\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/sqlmap_pass_acuart.png}
\caption{\textit{Dump} do campo \textit{pass} da tabela \textit{users} com \textit{sqlmap}. Fonte: Próprio autor}
\label{fig:dump_pass}
\end{figure}

A partir da integração entre análise de vulnerabilidade e ataques de teste foi possível obter os nomes de usuário e suas respectivas
senhas de acesso ao endereço \url{www.testphp.vulnweb.com}.

\subsection{Ataques de \textit{Cross Site Scripting}}\label{subsec:xss}

De acordo com a análise do \textit{Vega} dentre as 1535 ameaças encontradas em \url{www.hackthissite.org} (figura \ref{fig:vega_hack})
existem 23 possíveis endereços vulneráveis à \textit{Cross Site Scripting}. Os próximos passos se dão com o uso do \textit{XSSer}.

Através do endereço vulnerável disponibilizado pelo \textit{Vega} em sua análise de vulnerabilidade, inicia-se o \textit{XSSer} para iniciar
os testes de inserção de \textit{scripts}. Inúmeros casos de teste são executados, como é possível observar na figura \ref{fig:xss_hack}.

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/xsser_xss_hackthissite.png}
\caption{\textit{Scripts} inseridos em testes com \textit{XSSer}. Fonte: Próprio autor}
\label{fig:xss_hack}
\end{figure}

Ao final da execução, o \textit{XSSer} fornece dados estatísticos com relação aos testes realizados (figura \ref{fig:math_hack}).

\begin{figure}[H]
\centering
\includegraphics[width=0.8\textwidth]{imagens/xsser_estatistica_hackthissite.png}
\caption{Dados estatísticos dos testes com \textit{XSSer}. Fonte: Próprio autor}
\label{fig:math_hack}
\end{figure}

Diferente da coleta de dados restritos observada em \ref{subsec:sql_injection}, os testes de inserção com \textit{XSSer} modificam a página
com \textit{scripts} de outra origem que não o servidor de \url{www.hackthissite.org}.

\section{ANÁLISE DOS RESULTADOS}

Os ataques realizados em \ref{sec:attack} foram bem sucedidos, a manipulação de dados (vide \ref{subsec:sql_injection}) se mostrou 100\% efetiva
e a inserção de \textit{scripts} de outra origem (\ac{XSS}) (vide \ref{subsec:xss}) obteve 82\% de sucesso em seus casos de teste 
(figura \ref{fig:math_hack}).

A detecção das vulnerabilidades pelo \textit{Vega} garantem a possível manipulação do banco de dados (vide \ref{subsec:sql_injection}) e inserção
de \textit{scripts} maliciosos de origem desconhecida (vide \ref{subsec:xss}) por atacantes que podem se prover de acesso de escrita e leitura
para dados que não deveriam ter permissão (\textit{SQL Injection}) ou então manipular o conteúdo do site, suas funções e aparência, manipular a
aplicação sem conhecimento do usuário, retransmitir \textit{cookies} e outras funcionalidades.


\section{SOLUÇÕES PROPOSTAS}





\begin{comment}

  EXEMPLO DE FIGURA

  \begin{figure}[!h]
  \centering
  \includegraphics[scale=0.7]{sdnARCH.png}
  \caption{Diagrama da arquitetura de uma SDN.}
  \label{fig:sdnArch}
  \end{figure}

  EXEMPLO DE DESCRIÇÃO DE ALTERNATIVAS

  \begin{description}
      \item[Maxinet] Baseado no \textit{Mininet}, possui o objetivo de superar as limitações em relação ao
      número de dispositivos de rede que podem ser simulados. Segundo o autor~\cite{maxinet}, o \textit{Maxinet} tem
      como propósito simular grandes redes de \textit{data-centers} e superar o desempenho do \textit{Mininet} através
      da utilização de vários computadores trabalhando de forma distribuída. O \textit{Maxinet} contém \textit{built-in} um
      gerador de trafego de rede, baseado em recentes análises de casos reais.

      \item[Mininet-Hifi] O \textit{Mininet-Hifi}~\cite{mininethifi} é um projeto com a finalidade de melhorar
      a reprodutibilidade de testes realizados no \textit{Mininet}. Implementado de forma semelhante, utilizando 
      \textit{containers}, o \textit{Mininet-Hifi} utiliza de recursos adicionais para melhorar a reprodutibilidade. 
  \end{description}

\end{comment}




\chapter{CONCLUSÃO}

Conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
 conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
  conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
   conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
    conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
     conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
      conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
 conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
  conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão conclusão
  


